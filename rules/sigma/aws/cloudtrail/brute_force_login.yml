title: AWS Console Login Brute Force
id: aws-cloudtrail-brute-force-login-001
status: stable
description: Detects multiple failed console login attempts from the same source IP address, which may indicate a brute force attack
author: Mantissa Security Team
date: 2025-01-27
modified: 2025-01-27

logsource:
  product: aws
  service: cloudtrail

detection:
  selection_failed:
    eventName: ConsoleLogin
    errorCode:
      - Failed authentication
      - InvalidPassword
  timeframe: 15m
  condition: selection_failed | count(sourceIPAddress) by sourceIPAddress >= 10

fields:
  - sourceIPAddress
  - userIdentity.principalId
  - eventTime
  - userAgent

falsepositives:
  - Users legitimately forgetting passwords multiple times
  - Automated scripts with incorrect credentials
  - Password manager failures

level: high

tags:
  - attack.credential_access
  - attack.t1110
  - attack.t1110.001

references:
  - https://attack.mitre.org/techniques/T1110/
  - https://docs.aws.amazon.com/IAM/latest/UserGuide/cloudtrail-integration.html
