title: Duo Admin Role Assignment
id: itdr-duo-admin-grant-001
status: stable
description: |
  Detects when an administrator role is assigned in Duo Security.
  Duo admin accounts have significant control over authentication
  policies and can bypass or modify MFA requirements.

  Unauthorized admin grants in Duo are particularly dangerous as they
  can be used to weaken authentication controls across the organization.
author: Mantissa ITDR Team
date: 2025-01-28
modified: 2025-01-28

logsource:
  product: duo
  service: admin

detection:
  selection:
    action:
      - 'admin_create'
      - 'admin_update'
      - 'admin_role_update'
      - 'admin_permission_update'
  filter_privilege_grant:
    description|contains:
      - 'role'
      - 'admin'
      - 'permission'
      - 'owner'
  condition: selection and filter_privilege_grant
  timeframe: 24h

fields:
  - timestamp
  - action
  - description
  - object
  - username
  - actor_name
  - actor_email
  - ip_address
  - '@timestamp'

falsepositives:
  - IT onboarding new Duo administrators
  - Organizational role changes
  - Duo setup or reconfiguration

level: high

tags:
  - attack.persistence
  - attack.privilege_escalation
  - attack.t1078.004  # Valid Accounts: Cloud Accounts
  - attack.t1098      # Account Manipulation
  - attack.t1556.006  # Modify Authentication Process: MFA
  - itdr
  - identity
  - privilege
  - mfa

references:
  - https://attack.mitre.org/techniques/T1098/
  - https://attack.mitre.org/techniques/T1556/006/
  - https://duo.com/docs/adminapi

custom:
  itdr_category: privilege_escalation
  itdr_subcategory: admin_grant
  provider: duo
  duo_admin_roles:
    - name: "Owner"
      severity: critical
      description: "Full control over Duo account"
    - name: "Administrator"
      severity: high
      description: "Manage users, integrations, policies"
    - name: "Application Manager"
      severity: medium
      description: "Manage applications and integrations"
    - name: "User Manager"
      severity: medium
      description: "Manage end users"
    - name: "Help Desk"
      severity: low
      description: "Assist users with MFA"
    - name: "Read-only"
      severity: low
      description: "View-only access"
  critical_actions:
    - owner_role_assigned
    - admin_role_assigned
    - bypass_created
    - policy_weakened
  recommended_action: |
    1. Verify admin grant was authorized
    2. Check if actor is authorized to grant admin access
    3. Review if target needs admin access to Duo
    4. Examine source IP for anomalies
    5. Check for related policy or bypass changes
    6. If unauthorized, revoke admin access immediately
