title: Okta MFA Factor Deactivation
id: b2c3d4e5-f6a7-8901-2345-678901bcdefg
status: stable
description: Detects when multi-factor authentication is deactivated for a user account, which could indicate account compromise or policy bypass
author: Mantissa Security Team
date: 2025-01-28
modified: 2025-01-28

logsource:
  product: okta
  service: system

detection:
  selection:
    event.action:
      - 'user.mfa.factor.deactivate'
      - 'user.mfa.factor.reset_all'
      - 'system.mfa.factor.deactivate'
    event.outcome: 'success'
  condition: selection

fields:
  - user.name
  - user.email
  - okta.actor.alternate_id
  - okta.target.display_name
  - '@timestamp'
  - source.ip
  - okta.target.type

falsepositives:
  - Legitimate MFA reset by help desk
  - User-initiated MFA device replacement
  - Automated user offboarding processes

level: high

tags:
  - attack.defense_evasion
  - attack.credential_access
  - attack.t1078.004  # Valid Accounts: Cloud Accounts
  - attack.t1556      # Modify Authentication Process
