title: Google Workspace Admin Role Assignment
id: itdr-gws-admin-grant-001
status: stable
description: |
  Detects when an admin role is assigned to a user in Google Workspace.
  Admin role assignments should be carefully controlled and rare.
  Unexpected admin grants could indicate privilege escalation attacks,
  insider threats, or compromised admin accounts.
author: Mantissa ITDR Team
date: 2025-01-28
modified: 2025-01-28

logsource:
  product: google_workspace
  service: admin

detection:
  selection:
    event.name:
      - 'ASSIGN_ROLE'
      - 'ADD_PRIVILEGE'
      - 'GRANT_ADMIN_PRIVILEGE'
  filter_admin_roles:
    event.parameters.ROLE_NAME|contains:
      - 'ADMIN'
      - 'SUPER_ADMIN'
      - '_ADMIN'
  condition: selection and filter_admin_roles
  timeframe: 24h

fields:
  - actor.email
  - actor.profileId
  - event.name
  - event.parameters.ROLE_NAME
  - event.parameters.ROLE_ID
  - event.parameters.USER_EMAIL
  - event.parameters.GRANTEE_EMAIL
  - ipAddress
  - '@timestamp'

falsepositives:
  - Legitimate admin onboarding by IT
  - Organizational restructuring
  - New team setup requiring admin access
  - Temporary admin access for projects

level: high

tags:
  - attack.persistence
  - attack.privilege_escalation
  - attack.t1078.004  # Valid Accounts: Cloud Accounts
  - attack.t1098      # Account Manipulation
  - itdr
  - identity
  - privilege

references:
  - https://attack.mitre.org/techniques/T1098/
  - https://support.google.com/a/answer/33325
  - https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin

custom:
  itdr_category: privilege_escalation
  itdr_subcategory: admin_grant
  provider: google_workspace
  high_privilege_roles:
    - name: "_SUPER_ADMIN"
      severity: critical
      description: "Super Admin - full control"
    - name: "_ADMIN"
      severity: high
      description: "Standard admin roles"
    - name: "_SECURITY_ADMIN"
      severity: critical
      description: "Security administration"
    - name: "_USER_MANAGEMENT_ADMIN"
      severity: high
      description: "User management"
    - name: "_GROUPS_ADMIN"
      severity: medium
      description: "Groups administration"
    - name: "_SERVICES_ADMIN"
      severity: high
      description: "Services administration"
  role_prefix_mapping:
    "_SUPER_ADMIN": critical
    "_SECURITY": high
    "_USER_MANAGEMENT": high
    "_SERVICES": high
    "_GROUPS": medium
    "_HELP_DESK": medium
  recommended_action: |
    1. Verify admin grant was authorized through IT ticketing
    2. Check if granter has authority to assign admin roles
    3. Review target user's role and need for admin access
    4. Examine source IP and check for geo anomalies
    5. Review granter's recent activity for compromise indicators
    6. If unauthorized, immediately revoke the admin role
