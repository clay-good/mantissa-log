title: Snowflake Login Without MFA
id: snowflake-login-without-mfa-001
status: stable
description: |
    Detects successful logins to Snowflake without multi-factor authentication.
    All production accounts should require MFA for security.
references:
    - https://docs.snowflake.com/en/user-guide/security-mfa
    - https://attack.mitre.org/techniques/T1078/
author: Mantissa Log Security Team
date: 2025-01-28
tags:
    - attack.initial_access
    - attack.t1078
    - attack.t1078.004
logsource:
    product: snowflake
    service: login_history
detection:
    selection:
        event.action: user_login
        event.outcome: success
    filter_mfa:
        snowflake.login.second_auth_factor|exists: true
    condition: selection and not filter_mfa
falsepositives:
    - Service accounts that cannot use MFA
    - Legacy integrations during migration period
    - Development environments
level: medium
