title: Salesforce Admin Role Granted
id: sf-admin-role-granted-001
status: stable
description: |
    Detects when administrative privileges are granted to a user. This is a
    high-risk action that should be closely monitored for unauthorized
    privilege escalation.
references:
    - https://help.salesforce.com/s/articleView?id=sf.admin_roles.htm
    - https://attack.mitre.org/techniques/T1098/
author: Mantissa Log Security Team
date: 2025-01-28
tags:
    - attack.persistence
    - attack.privilege_escalation
    - attack.t1098
    - attack.t1098.001
logsource:
    product: salesforce
    service: setup_audit_trail
detection:
    selection:
        salesforce.audit_trail.section: Manage Users
        salesforce.audit_trail.display|contains:
            - 'System Administrator'
            - 'Administrator'
            - 'admin'
    filter_removed:
        salesforce.audit_trail.action|contains: 'removed'
    condition: selection and not filter_removed
falsepositives:
    - Legitimate admin provisioning
    - Emergency access grants
level: high
