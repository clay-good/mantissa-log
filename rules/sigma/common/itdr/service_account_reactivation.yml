title: Service Account Reactivation
id: itdr-common-service-account-reactivation-001
status: stable
description: |
  Detects when a service account that has been inactive becomes active again.
  Service accounts have predictable patterns - if one goes dormant and
  then reactivates, especially from a new location or with unusual behavior,
  it may indicate compromise or lateral movement.
author: Mantissa ITDR Team
date: 2025-01-28
modified: 2025-01-28

logsource:
  category: authentication
  # Applies to all identity providers

detection:
  selection:
    event_type:
      - 'AUTH_SUCCESS'
      - 'API_CALL'
      - 'TOKEN_USED'
  filter_service_account:
    # Service account naming patterns
    user_email|contains:
      - 'svc_'
      - 'service_'
      - 'srv-'
      - 'bot_'
      - 'automation'
      - 'system@'
      - 'noreply'
  condition: selection and filter_service_account
  # Post-processing: check if account was dormant
  timeframe: 24h

fields:
  - user_email
  - source_ip
  - source_geo.country
  - event_type
  - event_action
  - application_name
  - provider
  - '@timestamp'

falsepositives:
  - Scheduled jobs that run infrequently (monthly, quarterly)
  - Seasonal batch processing
  - Disaster recovery testing
  - Service restoration after maintenance

level: high

tags:
  - attack.persistence
  - attack.lateral_movement
  - attack.t1078.001  # Valid Accounts: Default Accounts
  - attack.t1078.004  # Valid Accounts: Cloud Accounts
  - itdr
  - identity
  - service_account

references:
  - https://attack.mitre.org/techniques/T1078/001/

custom:
  itdr_category: account_anomaly
  itdr_subcategory: service_account_reactivation
  provider: common
  detection_type: post_processing
  service_account_patterns:
    - "^svc_.*"
    - "^service_.*"
    - "^srv-.*"
    - "^bot_.*"
    - ".*automation.*"
    - "^system@.*"
    - ".*@service\\..*"
  dormant_threshold_days: 7
  severity_escalation:
    new_source_ip: critical
    new_application: high
    unusual_time: high
    multiple_providers: critical
  recommended_action: |
    1. Identify the service account owner/team
    2. Verify if reactivation is expected
    3. Check if source IP matches known infrastructure
    4. Review what operations were performed
    5. Check for lateral movement indicators
    6. If unexpected, disable service account immediately
    7. Rotate service account credentials
    8. Audit all systems using this service account
