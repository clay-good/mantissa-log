title: GCP Cloud SQL Public IP Enabled
id: gcp-audit-sql-public-001
status: stable
description: |
    Detects when a Cloud SQL instance is configured with a public IP.
    Public database access significantly increases attack surface.
references:
    - https://cloud.google.com/sql/docs/mysql/configure-ip
    - https://attack.mitre.org/techniques/T1190/
author: Mantissa Log Security Team
date: 2025-01-28
tags:
    - attack.initial_access
    - attack.t1190
logsource:
    product: gcp
    service: audit_logs
detection:
    selection:
        gcp.audit.service_name: sqladmin.googleapis.com
        gcp.audit.method_name|contains:
            - instances.update
            - instances.patch
    public_ip:
        gcp.request|contains: ipv4Enabled
    condition: selection and public_ip
falsepositives:
    - Legitimate public-facing databases
    - Development environments
level: high
