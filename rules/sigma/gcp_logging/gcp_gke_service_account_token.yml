title: GKE Service Account Token Created
id: gcp-gke-sa-token-001
status: stable
description: |
    Detects creation of service account tokens in GKE. Token creation
    could indicate credential theft or persistence mechanisms.
references:
    - https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging
    - https://attack.mitre.org/techniques/T1098/001/
author: Mantissa Log Security Team
date: 2025-01-28
tags:
    - attack.persistence
    - attack.credential_access
    - attack.t1098.001
logsource:
    product: gcp
    service: gke_audit_logs
detection:
    selection:
        gcp.gke.method_name|contains:
            - serviceaccounts.create
            - secrets.create
    token_type:
        gcp.request|contains: kubernetes.io/service-account-token
    condition: selection or (selection and token_type)
falsepositives:
    - Normal service account provisioning
    - Application deployments
level: medium
