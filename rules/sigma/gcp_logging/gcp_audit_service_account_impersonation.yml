title: GCP Service Account Impersonation
id: gcp-audit-sa-impersonation-001
status: stable
description: |
    Detects service account impersonation activities. Impersonation allows one
    identity to act as another service account, which can be abused for
    privilege escalation or lateral movement.
references:
    - https://cloud.google.com/iam/docs/impersonating-service-accounts
    - https://attack.mitre.org/techniques/T1550/001/
author: Mantissa Log Security Team
date: 2025-01-28
tags:
    - attack.privilege_escalation
    - attack.lateral_movement
    - attack.t1550.001
logsource:
    product: gcp
    service: audit_logs
detection:
    selection:
        gcp.audit.method_name|contains:
            - GenerateAccessToken
            - generateAccessToken
            - GenerateIdToken
            - generateIdToken
            - SignBlob
            - signBlob
            - SignJwt
            - signJwt
    condition: selection
falsepositives:
    - Legitimate service-to-service communication
    - Cloud Functions or Cloud Run invoking other services
level: medium
