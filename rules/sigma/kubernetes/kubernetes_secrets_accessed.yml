title: Kubernetes Secrets Accessed
id: b2c3d4e5-f6a7-8901-2345-678901bcdefg
status: stable
description: Detects access to Kubernetes secrets which may contain sensitive credentials
author: Mantissa Security Team
date: 2025-01-28
modified: 2025-01-28

logsource:
  product: kubernetes
  service: audit

detection:
  selection:
    event.action:
      - 'get'
      - 'list'
    kubernetes.object_ref.resource: 'secrets'
    event.outcome: 'success'
  filter_system:
    user.name:
      - 'system:serviceaccount:kube-system:*'
      - 'system:kube-controller-manager'
      - 'system:kube-scheduler'
  condition: selection and not filter_system

fields:
  - user.name
  - kubernetes.object_ref.namespace
  - kubernetes.object_ref.name
  - '@timestamp'
  - source.ip
  - user_agent.original

falsepositives:
  - Legitimate application access to secrets
  - CI/CD pipelines
  - Monitoring and backup systems

level: medium

tags:
  - attack.credential_access
  - attack.t1552  # Unsecured Credentials
  - attack.t1078  # Valid Accounts
